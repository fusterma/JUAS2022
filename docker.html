<!DOCTYPE html>                            <html>                                <head>                                    <meta charset="UTF-8">                                    <title>docker</title>                                    <link rel="stylesheet" href="./style/style.css">                                    <link rel="stylesheet" href="./style/kimbie.dark.css">                                    <meta name="viewport" content="width=device-width, initial-scale=1.0">                                    <style>*,body{margin:0;padding:0}.markdown-content,*{font-family:Vazir}*{box-sizing:border-box}html{font-size:14px}.markdown-content p,.rtl ol li,.rtl ul li{font-size:1.1rem}body{direction:rtl;color:#24292e}.ltr{direction:ltr!important}.rtl{direction:rtl!important}@media screen and (max-width:600px){body{padding:10px}}@media screen and (min-width:601px){body{padding:50px}}@font-face{font-family:Vazir;src:url(fonts/Vazir.woff)}@font-face{font-family:DejaVuSansMono;src:url(fonts/DejaVuSansMono.ttf)}.markdown-content{width:100%;outline-offset:-22px;padding:15px;line-height:3rem}code,code span,pre code span,ul li pre code{font-family:DejaVuSansMono,Menlo,'Liberation Mono',Consolas,'DejaVu Sans Mono','Ubuntu Mono','Courier New','andale mono','lucida console',monospace!important}.markdown-content p{text-align:justify;padding:.5rem}.markdown-content img{margin:0 auto;display:block;max-width:90%}.rtl ul li{margin-right:3rem!important}.rtl ol li{margin-right:3rem}.ltr ol li,.ltr ul li{font-size:1.1rem;margin-left:3rem}.markdown-content h1,.markdown-content h2,.markdown-content h3{padding:12px;text-shadow:none}.markdown-content h1{padding-top:60px;color:rgba(22,19,19,.8);font-weight:900;font-size:2.1rem}.markdown-content h2{font-weight:500;color:rgba(22,19,19,.6);font-size:1.8rem}.markdown-content h3{font-weight:300;color:rgba(22,19,19,.4);font-size:1.5rem}.markdown-content h4,.markdown-content h5{font-weight:200;color:rgba(22,19,19,.4)}.markdown-content h4{font-size:1.3rem}.markdown-content h5{font-size:1.2rem}@media screen and (min-width:48rem){#list{width:20%}#content{width:100%}}@media screen and (min-width:80rem){#list.none{display:inline-block}#content{width:80%}}@media print{#list{display:none}#content{display:block;width:100%;margin:0 auto}#content li,#content p{font-size:1rem}}.manual-anchor{top:45px}.markdown-container{max-width:1448px;margin:0 auto}.manual-link-icon{color:#8f8f8f}.manual-link-icon:hover{color:#000}code,ul li pre code{white-space:pre;word-wrap:normal;padding:3px 7px;color:#24292e;background-color:rgba(27,31,35,.05);border-radius:3px;font-size:1rem}.markdown-content ul li pre,.manual ul li pre,pre{margin:0;direction:ltr!important}.markdown-content ul li pre code,.manual ul li pre code,pre code{direction:ltr!important;line-height:1.45;padding:1em 0 .5em 3em;position:relative;display:block;overflow-x:auto;overflow-y:auto}a{text-decoration:none}.title{float:left;color:#ccc}.markdown-container{padding-top:60px}.elements{padding:12px;position:fixed;top:0;right:0;left:0;background-color:#444;height:50px;z-index:1}.input{color:#fff}#savebutton,input{font-size:15px}#savebutton{padding:0 7px!important}#rtl-checkbox-container{margin:3px 15px!important;color:#fff}.button{background-color:#fff;color:#444;font-size:1.6rem;display:inline-block;text-align:center;line-height:2.1rem;border-radius:2px}.button:hover{cursor:pointer;background-color:#eee}#refresh-button{width:2.2rem;vertical-align:middle}@media print{.no-print,.no-print *{display:none!important}}.hljs-comment,.hljs-quote{color:#99ac5b}.hljs-meta,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#dc3958}.hljs-built_in,.hljs-builtin-name,.hljs-deletion,.hljs-link,.hljs-literal,.hljs-number,.hljs-params,.hljs-type{color:#f79a32}.hljs-attribute,.hljs-section,.hljs-title{color:#f06431}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#9c9}.hljs-function,.hljs-keyword,.hljs-selector-tag{color:#98676a}.hljs{display:block;overflow-x:auto;background:#221a0f;color:#d3af86}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style>                                </head>                                <body><div class="markdown-container ltr"><div class="markdown-content"><h1 id="juas2022-mad-x">JUAS2022, MAD-X</h1>
<p>During JUAS 2022, we will use Python as scripting language for the <em>MAD-X</em> course. We kindly ask you to make some "homework" before JUAS 2022 to prepare your laptop for the course.</p>
<p>For this course a <strong>basic knowledge of Python is assumed</strong>, in case you are not familiar with it an introduction to python video and a tutorial to fill the gap are provided in indico. </p>
<p>During the course we will use Python3 in a Jupyter notebook and, mostly, the <em>numpy</em>, <em>matplotlib</em>, <em>pandas</em> and <em>cpymad</em> packages. </p>
<h2 id="jupyter-notebooks">Jupyter-notebooks</h2>
<p>Jupyter is a user-friendly environment to work with Python. You can find an overview <a href="https://jupyter.org/">here</a>.</p>
<h2 id="working-environment-and-jupyter-notebooks-set-up">Working environment and Jupyter notebooks set-up</h2>
<p>We provide the following approaches to set-up the working environment for the MAD-X course:</p>
<ul>
<li>Install Docker and run a Docker image we have prepared for you (to work locally in your PC).</li>
<li>Install python and packges using Anaconda (to work locally in your PC).</li>
<li>Use Binder (to work online on a browser).</li>
</ul>
<p>The first two approaches allow you to work locally in your computer while the third one not. We recommend you to work locally in your PC as it will be easier to save your work and keep the tool for private use later, but the third option to work directly on a browser is also available in case you have problems with the local set-up. </p>
<p>In the following we will explain how to <strong>install locally</strong> the required software: we propose different approaches for OSX, UNIX and Windows systems, respectively.</p>
<p>For <strong>OSX</strong> users, please follow the instructions in the <em>OSX: Install and run a Docker image</em> section.</p>
<p>For <strong>UNIX</strong> users, please follow  the instructions in the instructions in the <em>UNIX: Anaconda + cpymad</em> section.</p>
<p>For the <strong>Windows</strong> users, please follow  the instructions in the <em>Windows: Docker Desktop</em> section.</p>
<h1 id="osx-install-and-run-a-docker-image">OSX: install and run a Docker image</h1>
<p>In order to  ease the installation procedure, we prepared a virtual environment that launch a Python3 Jupyter server (the installation on <em>cpymad</em> on OSX can be tricky, so we suggest to use the Docker image as suggested).</p>
<h3 id="step-1-install-the-docker-desktop">STEP 1: install the Docker Desktop</h3>
<p>Please install the <a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a>. </p>
<h3 id="step-2-run-the-docker-image">STEP 2: run the Docker image</h3>
<p>Once the Docker Desktop is installed and running, open a terminal and run the instruction</p>
<pre><code class="lang-bash hljs "><span class="hljs-meta">&gt;&gt;</span> docker run --rm -p <span class="hljs-number">8888</span><span class="hljs-symbol">:</span><span class="hljs-number">8888</span> -v $PWD<span class="hljs-symbol">:/src/juas/</span>  juastest/juas2022
</code></pre>
<p>This will download the image (~5GB): an internet connection is needed <strong>only for the first time</strong>, afterwords you can work offline. 
In addition, this command binds your home directory to inside the docker container such that you can save and load notebooks.
You should get something as</p>
<pre><code class="lang-bash hljs ">MACBE16107:Tutorials sterbini$ docker run -p <span class="hljs-number">8888</span>:<span class="hljs-number">8888</span> -v <span class="hljs-string">"$PWD"</span>:/juas sterbini/juas
[<span class="hljs-meta">I 08:37:31.108 LabApp</span>] Writing notebook server cookie secret to /cas/.local/share/jupyter/runtime/notebook_cookie_secret
[<span class="hljs-meta">I 08:37:31.341 LabApp</span>] JupyterLab extension loaded <span class="hljs-keyword">from</span> /opt/conda/lib/python3<span class="hljs-number">.6</span>/site-packages/jupyterlab
[<span class="hljs-meta">I 08:37:31.341 LabApp</span>] JupyterLab application directory <span class="hljs-keyword">is</span> /opt/conda/share/jupyter/lab
[<span class="hljs-meta">W 08:37:31.343 LabApp</span>] JupyterLab server extension not enabled, manually loading...
[<span class="hljs-meta">I 08:37:31.353 LabApp</span>] JupyterLab extension loaded <span class="hljs-keyword">from</span> /opt/conda/lib/python3<span class="hljs-number">.6</span>/site-packages/jupyterlab
[<span class="hljs-meta">I 08:37:31.353 LabApp</span>] JupyterLab application directory <span class="hljs-keyword">is</span> /opt/conda/share/jupyter/lab
[<span class="hljs-meta">I 08:37:31.354 LabApp</span>] Serving notebooks <span class="hljs-keyword">from</span> local directory: /cas
[<span class="hljs-meta">I 08:37:31.354 LabApp</span>] The Jupyter Notebook <span class="hljs-keyword">is</span> running at:
[<span class="hljs-meta">I 08:37:31.354 LabApp</span>] http:<span class="hljs-comment">//(4bd247dca0ba or 127.0.0.1):8888/?token=ea65f062bfce037fd7a3b47926393a0d5ded381785b0136b</span>
[<span class="hljs-meta">I 08:37:31.355 LabApp</span>] Use Control-<span class="hljs-function">C to stop <span class="hljs-keyword">this</span> server and shut down all <span class="hljs-title">kernels</span> (<span class="hljs-params">twice to skip confirmation</span>).
[C 08:37:31.364 LabApp] 

    Copy/paste <span class="hljs-keyword">this</span> URL <span class="hljs-keyword">into</span> your browser when you connect <span class="hljs-keyword">for</span> the first time,
    to login with a token:
        http:<span class="hljs-comment">//127.0.0.1:8888/?token=ea65f062bfce037fd7a3b47926393a0d5ded381785b0136b</span></span>
</code></pre>
<p>:::info</p>
<p><strong>The last line is the most important one</strong>.</p>
<p>:::</p>
<p>:::info</p>
<p>The argument <strong>$PWD:/src/juas/</strong> on the command line makes the synchronization between the docker image folder and your local machine. It is important that you set-up the Docker Desktop configuration to allow it by adding the path to your Desktop on: Docker Preferences -&gt; Resources -&gt; File sharing. The procedure is llustrated here: <img alt="Captura de pantalla 2021-12-15 a las 18 43 46" src="https://user-images.githubusercontent.com/72798799/146238094-7e75702d-9f87-4ad5-9d7e-5ae9d2dbf8c1.png" width="1429"></p>
<p>:::</p>
<h3 id="step-3-open-a-jupyter-notebook-from-a-browser">STEP 3: open a jupyter-notebook from a browser</h3>
<p>Open a web browser and connect to the python server at (<strong>in this case</strong>, check the last line)
<a href="http://127.0.0.1:8888/?token=ea65f062bfce037fd7a3b47926393a0d5ded381785b0136b">http://127.0.0.1:8888/?token=ea65f062bfce037fd7a3b47926393a0d5ded381785b0136b</a></p>
<p>You have to copy and paste the last line on the address field of your browser.</p>
<p>You should see something like <a href="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png">https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png</a> but with the folders on your Desktop.</p>
<p>This Jupyter-notebook environment is setup with the software needed for the MAD-X tutorials.</p>
<p>Now you can create a new folder where to save your jupyter-notebook (right top buttom NEW) and also clic on <em>NEW-&gt; Python 3 Notebook</em> on the right top icon (<a href="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png">https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png</a>) and test the code example at the end of this document to verify that everything is working as expected.</p>
<h1 id="unix-anaconda-distribution">UNIX: Anaconda distribution</h1>
<p>For UNIX system the simplest way to install Python environment on your laptop is to setup manually your environment by installing <a href="http://docs.continuum.io/_downloads/9ee215ff15fde24bf01791d719084950/Anaconda-Starter-Guide.pdf"><em>anaconda</em></a> from<br><a href="http://docs.continuum.io/anaconda/">http://docs.continuum.io/anaconda/</a> (go to the bottom of the web page).</p>
<h3 id="step-1-anaconda-installation">STEP 1: Anaconda installation</h3>
<p>We suggest to install the Python 3.9 version (latest)
<a href="https://www.anaconda.com/distribution/">https://www.anaconda.com/distribution/</a>. </p>
<p>List the packages that are installed with</p>
<pre><code class=" hljs "><span class="hljs-meta">&gt;&gt;</span> conda list
</code></pre><p>and verify that you have <em>matplotlib</em>, <em>numpy</em>, <em>scipy</em>, <em>pandas</em>, <em>sympy</em>.
If some of them are missing, please install them with, e.g.,</p>
<pre><code class=" hljs "><span class="hljs-meta">&gt;&gt;</span> conda install -c conda-forge matplotlib
</code></pre><h3 id="step-2-cpymad-installation">STEP 2: <em>cpymad</em> installation</h3>
<p>The standard <em>anaconda</em> distribution comes with most of the needed packages but <em>cpymad</em>. You can install it following the instructions from <a href="https://github.com/hibtc/cpymad">https://github.com/hibtc/cpymad</a>. In most of the case it is enough to open a terminal and do</p>
<pre><code class=" hljs "><span class="hljs-meta">&gt;&gt;</span> pip install cpymad
</code></pre><h3 id="step-3-jupyter">STEP 3: Jupyter</h3>
<p>Now you can launch from a terminal Jupyter</p>
<pre><code class=" hljs "><span class="hljs-meta">&gt;&gt;</span> jupyter-notebook
</code></pre><p>:::info
If Jupyter-notebook is not installed in your system you can install it with </p>
<pre><code class=" hljs "><span class="hljs-meta">&gt;&gt;</span> conda install -c conda-forge notebook
</code></pre><p>:::</p>
<p>The <em>jupyter-notebook</em> command will open a browser.</p>
<p>You can clic on the NEW-&gt;Python 3 Notebook icon on the top right (<a href="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png">https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png</a>) and test the code example at the end of this document to verify that everything is working as expected.</p>
<h1 id="windows-docker-desktop">Windows: Docker Desktop</h1>
<h3 id="step-1-install">STEP 1: install</h3>
<p>If you have <strong>Windows 10 Home, Professional or Enterprise</strong> you can follow <strong>the instructions given for OSX</strong> and install the Docker Desktop from <a href="https://docs.docker.com/desktop/windows/install/">here</a> .</p>
<p>:::info</p>
<p>In order to have Docker running properly the virtualization needs to be activated. If you have problems running Docker due to this problem please follow the steps explained here: <a href="https://mashtips.com/enable-virtualization-windows-10/">https://mashtips.com/enable-virtualization-windows-10/</a>.</p>
<p>:::</p>
<h3 id="step-2-launch-the-docker-image">STEP 2:launch the docker image</h3>
<p>Now open the Docker Quickstart (icon on the Desktop). It will take some time to start the virtual machine. Then open a Command Prompt window using the cmd program and move to your home folder typing</p>
<pre><code class="lang-bash hljs "><span class="hljs-meta">&gt;&gt;</span> cd
</code></pre>
<p>Then type</p>
<pre><code class="lang-bash hljs "><span class="hljs-meta">&gt;&gt;</span> docker run -p <span class="hljs-number">8888</span><span class="hljs-symbol">:</span><span class="hljs-number">8888</span> -v %cd%<span class="hljs-symbol">:/src/juas/</span>  juastest/juas2022
</code></pre>
<p>This download the docker image (only for the first time, ~5 GB) and run it.</p>
<p>You will get something like (<a href="https://user-images.githubusercontent.com/72798799/146367178-20318779-e336-4de1-870e-61562f2d16c3.png">https://user-images.githubusercontent.com/72798799/146367178-20318779-e336-4de1-870e-61562f2d16c3.png</a>)</p>
<p>:::info</p>
<p><strong>The last line is the most important one</strong>.</p>
<p>:::</p>
<h3 id="step-3-open-jupyter-from-a-browser">STEP 3: open Jupyter from a browser</h3>
<p>Open a web browser and connect to the python server at (<strong>in this case</strong>, see the last line of the previous screenshot)
<a href="http://127.0.0.1:8888/?token=HereGoesYourAlphanumericToken">http://127.0.0.1:8888/?token=HereGoesYourAlphanumericToken</a></p>
<p>It will open a browser and you should get something like 
<img src="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png" alt=""></p>
<p>You can clic on the NEW-&gt;Python 3 Notebook icon on the top right (<a href="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png">https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png</a>) and test the code example at the end of this document to verify that everything is working as expected.</p>
<h1 id="problems-with-the-set-up-">Problems with the set-up.</h1>
<p>If you have problems with the set-up you can contact us by email and we will be happy to help (nuria.fuster@ific.uv.es).</p>
<p>Otherwise you can work during the MAD-X tutorial directly on a browser through binder (<a href="https://mybinder.org/">https://mybinder.org/</a>). We will provide you with the links to the jupyter-notebooks but special attention has to be paid using this approach to save the progress by downloading the jupyter-notebooks at the end of the workshop or your progress will be lost. </p>
<p>You can try here <a href="https://mybinder.org/v2/gh/fusterma/MADX_JUAS2022/HEAD?filepath=test.ipynb">https://mybinder.org/v2/gh/fusterma/MADX_JUAS2022/HEAD?filepath=test.ipynb</a></p>
<p>You can clic on the NEW-&gt;Python 3 Notebook icon on the top right (<a href="https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png">https://user-images.githubusercontent.com/72798799/146044142-2c6c33bb-427c-4326-80a2-a2642bc0833e.png</a>) and test the code example at the end of this document to verify that everything is working as expected.</p>
<h1 id="an-example-of-python3-notebook-">An example of Python3 notebook.</h1>
<p>Open a new Python3 jupyter notebook: NEW-&gt;Python 3 Notebook and copy and paste the following lines on the jupyter-notebook boxes and give it a try!</p>
<p>You can import the python library of MAD-X (<em>cpymad</em>) with the following command.</p>
<pre><code class="lang-python hljs "><span class="hljs-keyword">from</span> cpymad.madx <span class="hljs-keyword">import</span> Madx
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt
myMad = Madx()
</code></pre>
<p>and now you can twiss a simple FODO cell (more details during the course) with the following code</p>
<pre><code class="lang-python hljs ">myString='''
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Second part
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Definition of parameters
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*

l_cell=100;
quadrupoleLenght=5;
f=200;
myK:=1/f/quadrupoleLenght;// m^-2

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Definition of magnet
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>* 
QF: quadrupole, L=quadrupoleLenght, K1:=myK;
QD: quadrupole, L=quadrupoleLenght, K1:=-myK;

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Definition of sequence
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
myCell:sequence, refer=entry, L=L_CELL;
quadrupole1: QF, at=0;
marker1: marker, at=25;
quadrupole2: QD, at=50;
endsequence;

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Definition of beam
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
beam, particle=proton, energy=2;

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! Use of the sequence
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
use, sequence=myCell;

! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
! TWISS
! <span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-strong">*****</span><span class="hljs-emphasis">***</span>*
title, 'My first twiss';
twiss, file=myFirstTwiss.twiss;
'''
myMad.input(myString);
</code></pre>
<p>You can see the <em>Q1</em> and <em>betymax</em> parameters by executing this cell</p>
<pre><code class="lang-python hljs ">myString=<span class="hljs-string">'''
value, table(SUMM,Q1);
value, table(SUMM,betymax);
'''</span>
myMad.input(myString);
</code></pre>
<p>and you can get a pandas dataframe with the information of the lattice by</p>
<pre><code class="lang-python hljs ">myDF=myMad.table.twiss.dframe()
myDF[[<span class="hljs-string">'name'</span>,<span class="hljs-string">'s'</span>,<span class="hljs-string">'betx'</span>,<span class="hljs-string">'bety'</span>]].head()
</code></pre>
<p>You should get something like
<img src="https://codimd.web.cern.ch/uploads/upload_6ffb4ff57ec6f11c385e9a405604b1c3.png" alt=""></p>
<p>To plot some data of the <em>twiss</em> table you can execute</p>
<pre><code class="lang-python hljs ">plt.plot(myDF[<span class="hljs-string">'s'</span>],myDF[<span class="hljs-string">'betx'</span>],<span class="hljs-string">'ob-'</span>)
plt.plot(myDF[<span class="hljs-string">'s'</span>],myDF[<span class="hljs-string">'bety'</span>],<span class="hljs-string">'or-'</span>)
plt.legend()
plt.grid()
plt.xlabel(<span class="hljs-string">'s [m]'</span>)
plt.ylabel(<span class="hljs-string">'[m]'</span>)
plt.title(<span class="hljs-string">'My first FODO cell'</span>)
</code></pre>
<p><img src="https://codimd.web.cern.ch/uploads/upload_468cfab86d69ef405edce079a68b399f.png" alt=""></p>
<p>You can do also a bit of symbolic computation with </p>
<pre><code class="lang-python hljs ">import sympy as sy
import numpy as np
from sympy import init_session
init_session() 
la=np.linalg
L_cell=sy.Symbol('L_cell', positive=True);
f_1=sy.Symbol('f_1', positive=True);
f_2=sy.Symbol('f_2', positive=True);
f=sy.Symbol('f', positive=True);

QF=sy.Matrix([[1,0], [-1/f,1]])
DRIFT=sy.Matrix([[1,L_cell/2], [0,1]])
QD=sy.Matrix([[1,0], [1/f,1]])
<span class="hljs-comment"># This is the OTM </span>
M=DRIFT@QD@DRIFT@QF
M=sy.simplify(M)
M
</code></pre>
<p>An example of test ipython notebook is shown in</p>
<p><a href="https://cernbox.cern.ch/index.php/s/JJCu7KRPAjuitVF">https://cernbox.cern.ch/index.php/s/JJCu7KRPAjuitVF</a></p>
<p>You will learn much more at JUAS 2022. <strong>See you (remotely)  there!</strong></p>
</div></div></body>                            </html>